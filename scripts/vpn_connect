#!/bin/bash
openvpn_connections=$(nmcli connection show | awk '$3 == "vpn" {print $1}')
expressvpn_connections=$(expressvpn list all | tail -n +3)

selection=$(echo -e "$openvpn_connections\n$expressvpn_connections" | rofi -dmenu -i | awk '{print $1}')
if [[ $openvpn_connections == *"$selection"* ]]; then
    output="$(nmcli c up "${selection}" 2>&1)"
else
    output="$(expressvpn connect "${selection}" 2>&1 | grep 'Connected')"
fi
output=$(echo "$output" | sed 's/\x1B\[[0-9;]\{1,\}[A-Za-z]//g')
notify-send "VPN" "$output"
echo "$output"
